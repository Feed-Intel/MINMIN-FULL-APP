server {
  listen 80;
  # Support local and staging domains
  server_name restaurant.local stg.restaurant.feed-intel.com restaurant.feed-intel.com;

  # ACME HTTP-01 challenge (Let's Encrypt)
  location ^~ /.well-known/acme-challenge/ {
    alias /var/www/certbot/.well-known/acme-challenge/;
    default_type text/plain;
    access_log off;
  }

  root /usr/share/nginx/html/restaurant;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }

  location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
    access_log off;
    expires 7d;
    try_files $uri =404;
  }
}

# HTTPS for Restaurant (staging)
server {
  listen 443 ssl http2;
  server_name stg.restaurant.feed-intel.com;

  ssl_certificate     /etc/nginx/tls/live/stg.restaurant.feed-intel.com/fullchain.pem;
  ssl_certificate_key /etc/nginx/tls/live/stg.restaurant.feed-intel.com/privkey.pem;
  ssl_session_cache off;
  ssl_protocols TLSv1.2 TLSv1.3;

  root /usr/share/nginx/html/restaurant;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }

  location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
    access_log off;
    expires 7d;
    try_files $uri =404;
  }
}
